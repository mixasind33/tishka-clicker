<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tishka Coin</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <div class="header-pill left" onclick="openModal('modal-settings')">
            <div class="icon-circle">‚öôÔ∏è</div>
            <div style="display:flex; flex-direction:column; align-items:flex-start;">
                <span class="league-text" id="league-disp">Bronze</span>
                <span id="cloud-status" style="font-size:10px; color:#aaa;">‚òÅÔ∏è ...</span>
            </div>
        </div>
        <div class="header-pill right">
            <div class="icon-circle gold">üí∞</div>
            <span id="h-coins">0</span>
        </div>
    </header>

    <div class="content">
        <div id="game" class="tab active">
            <div class="game-controls">
                <div class="control-btn" onclick="openModal('modal-wheel')">üé∞<span class="control-label">–§–æ—Ä—Ç—É–Ω–∞</span></div>
                <div class="control-btn" onclick="openModal('modal-claw')">üïπÔ∏è<span class="control-label">–ö—Ä–∞–Ω</span></div>
                <div class="control-btn" onclick="openModal('modal-promo')">üîë<span class="control-label">–ö–æ–¥</span></div>
                <div class="control-btn" onclick="openModal('modal-settings')">‚öôÔ∏è<span class="control-label">–ú–µ–Ω—é</span></div>
            </div>

            <div class="daily-bonus-float" id="daily-btn" onclick="claimDaily()">
                <span class="daily-icon">üéÅ</span>
                <span class="daily-text">–ë–æ–Ω—É—Å</span>
            </div>

            <div class="circle-container">
                <div id="pets-container"></div>
                <div id="click-circle" onpointerdown="clickCoin(event)">
                    <div class="tishka-face-container" style="width:100%; height:100%; display:flex; justify-content:center; align-items:center;">
                        <svg class="cat-svg" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M100 180C144.183 180 180 144.183 180 100C180 55.8172 144.183 20 100 20C55.8172 20 20 55.8172 20 100C20 144.183 55.8172 180 100 180Z" fill="#151515" />
                            <ellipse cx="65" cy="90" rx="22" ry="28" fill="#FFD700" />
                            <ellipse cx="135" cy="90" rx="22" ry="28" fill="#FFD700" />
                            <ellipse cx="65" cy="90" rx="5" ry="18" fill="black" />
                            <ellipse cx="135" cy="90" rx="5" ry="18" fill="black" />
                            <path d="M92 125L108 125L100 135Z" fill="#FFB6C1" />
                            <g id="skin-layer"></g>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="skills-row">
                <div class="skill-btn" id="skill-1" onclick="useSkill('catnip')">üåø</div>
                <div class="skill-btn" id="skill-2" onclick="useSkill('zoomies')">‚ö°</div>
            </div>
        </div>

        <div class="energy-float-bar">
            <div class="energy-text-float">‚ö° <span id="energy-val">1000</span> / <span id="max-energy-val">1000</span></div>
            <div class="energy-bar-bg"><div class="energy-fill-float" id="energy-bar"></div></div>
        </div>

        <div id="shop" class="tab" style="padding-top: 150px;">
            <h2 class="shop-header">‚ú® –ú–ê–ì–ê–ó–ò–ù ‚ú®</h2>
            <div class="shop-tabs">
                <button class="shop-tab-btn active" onclick="switchShopTab('upgrades', this)">‚ö° –£–ª—É—á—à–µ–Ω–∏—è</button>
                <button class="shop-tab-btn" onclick="switchShopTab('skins', this)">üëï –û–¥–µ–∂–¥–∞</button>
            </div>
            <div id="shop-upgrades" class="shop-section active">
                <div class="card" onclick="openModal('modal-lootbox')">
                    <div style="display:flex;align-items:center;"><div class="card-icon">üì¶</div><div class="card-info"><h4>–õ—É—Ç–±–æ–∫—Å</h4><p>–ò—Å–ø—ã—Ç–∞–π —É–¥–∞—á—É</p></div></div><button class="buy-btn">5000 üí∞</button>
                </div>
                <div class="card"><div style="display:flex;align-items:center;"><div class="card-icon">üêæ</div><div class="card-info"><h4>–ü–∏—Ç–æ–º–µ—Ü –ú—É—Ö–∞</h4><p>+2 –º–æ–Ω–µ—Ç/—Å–µ–∫</p></div></div><button class="buy-btn" onclick="buyPet('fly', 10000)">10k üí∞</button></div>
                <div class="card"><div style="display:flex;align-items:center;"><div class="card-icon">üëÜ</div><div class="card-info"><h4>–ö–æ–≥—Ç–∏</h4><p>–°–∏–ª–∞ –∫–ª–∏–∫–∞</p></div></div><button class="buy-btn" id="btn-click" onclick="buy('click')"></button></div>
                <div class="card"><div style="display:flex;align-items:center;"><div class="card-icon">ü§ñ</div><div class="card-info"><h4>–ö–æ—Ç–æ-–ë–æ—Ç</h4><p>–ê–≤—Ç–æ-–¥–æ—Ö–æ–¥</p></div></div><button class="buy-btn" id="btn-auto" onclick="buy('auto')"></button></div>
                <div class="card"><div style="display:flex;align-items:center;"><div class="card-icon">üîã</div><div class="card-info"><h4>–ë–∞—Ç–∞—Ä–µ–π–∫–∞</h4><p>–ú–∞–∫—Å. —ç–Ω–µ—Ä–≥–∏—è</p></div></div><button class="buy-btn" id="btn-max" onclick="buy('max')"></button></div>
            </div>
            <div id="shop-skins" class="shop-section"><div id="skins-grid" class="shop-grid"></div></div>
        </div>

        <div id="boss-tab" class="tab" style="padding-top: 150px;">
            <h2 class="shop-header" style="color:red; text-shadow: 0 0 10px red;">–ê–†–ï–ù–ê –ë–û–°–°–ê</h2>
            <div class="boss-stats-card">
                <div style="font-size:40px;">‚öîÔ∏è</div>
                <div><div style="color:#ccc; font-size:12px;">–¢–≤–æ–π –£—Ä–æ–Ω</div><div style="font-size:24px; font-weight:bold; color:#ff5555;" id="boss-dmg-val">200</div></div>
            </div>
            <div class="boss-area-container">
                <div class="boss-placeholder" style="font-size:100px;">üòà</div>
                <button class="boss-start-btn" onclick="startBossCapture()">–í–´–ó–í–ê–¢–¨ –ë–û–°–°–ê</button>
            </div>
            <div class="boss-upgrade-row">
                <div class="upgrade-info"><div style="font-weight:bold; color:#fff;">–û—Å—Ç—Ä—ã–π –ú–µ—á</div><div style="font-size:12px; color:#ccc;">+50 –∫ –£—Ä–æ–Ω—É –ø–æ –±–æ—Å—Å—É</div></div>
                <button class="buy-btn" id="btn-upgrade-sword" onclick="upgradeBossDamage()">1000 üí∞</button>
            </div>
        </div>

        <div id="factory" class="tab">
            <h2 class="shop-header">üè≠ –§–ê–ë–†–ò–ö–ê</h2>
            <div class="factory-container">
                <div class="factory-stats">
                    <div class="stat-box"><div class="stat-icon">üêÆ</div><div class="stat-val" id="cow-count">0</div></div>
                    <div class="stat-box"><div class="stat-icon">ü•õ</div><div class="stat-val" id="milk-rate">0/c</div></div>
                </div>
                <div class="truck-section">
                    <div class="truck-visual"><div style="font-size:40px;">üöö</div><div class="truck-bar-container"><div class="truck-bar-fill" id="truck-fill"></div></div></div>
                    <div class="truck-info"><span id="milk-storage">0</span> / <span id="milk-max">50</span> –õ</div>
                    <button class="buy-btn" id="btn-sell-milk" onclick="sellMilk()" style="background:#4ade80; color:#003300; width:100%; margin-top:10px;">–ü–†–û–î–ê–¢–¨ (+0üí∞)</button>
                </div>
                <div class="factory-controls">
                    <div class="card"><div style="text-align:left;"><h4>–ö–æ—Ä–æ–≤–∞</h4><p>+1 –õ/—Å–µ–∫</p></div><button class="buy-btn" id="btn-buy-cow" onclick="buyCow()">5000 üí∞</button></div>
                    <div class="card"><div style="text-align:left;"><h4>–ì—Ä—É–∑–æ–≤–∏–∫</h4><p>+50 –ú–µ—Å—Ç–∞</p></div><button class="buy-btn" id="btn-upgrade-truck" onclick="upgradeTruck()">2000 üí∞</button></div>
                </div>
            </div>
        </div>

        <div id="modal-settings" class="modal-overlay">
            <div class="modal">
                <button class="close-btn" onclick="closeModal('modal-settings')">‚úï</button>
                <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                <button class="buy-btn" style="background:var(--danger); margin-top:20px;" onclick="doPrestige()">–†–ï–ë–ò–¢ (–°–±—Ä–æ—Å)</button>
                <div style="margin-top:20px; font-size:10px; color:#444;">ID: <span id="player-id">LOADING...</span></div>
                <button class="buy-btn" style="background:#555; width:100%; margin-top:15px;" onclick="testConnection()">üõ†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ</button>
            </div>
        </div>

        <div id="modal-offline" class="modal-overlay">
            <div class="modal">
                <h2>–° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!</h2>
                <p>–¢—ã –∑–∞—Ä–∞–±–æ—Ç–∞–ª:</p>
                <h1 style="color:#ffd700;">+<span id="offline-amount">0</span></h1>
                <button class="buy-btn" onclick="closeModal('modal-offline')">–ó–ê–ë–†–ê–¢–¨</button>
            </div>
        </div>
        
        <div id="modal-daily" class="modal-overlay"><div class="modal"><button class="close-btn" onclick="closeModal('modal-daily')">‚úï</button><h2>–ë–æ–Ω—É—Å—ã</h2><div class="daily-grid" id="daily-grid"></div><button class="buy-btn" id="claim-daily-btn" onclick="claimDailyReward()">–ó–ê–ë–†–ê–¢–¨</button></div></div>
        <div id="modal-purchase" class="modal-overlay"><div class="modal purchase-modal"><h2>–£—Å–ø–µ—à–Ω–æ!</h2><p id="purchase-text"></p><button class="buy-btn purchase-continue" onclick="closeModal('modal-purchase')">–û–ö</button></div></div>
        
        <nav>
            <button class="nav-item active" onclick="switchTab('game', this)"><span>üéÆ</span><div>–ò–≥—Ä–∞</div></button>
            <button class="nav-item" onclick="switchTab('shop', this)"><span>üõí</span><div>–ú–∞–≥–∞–∑–∏–Ω</div></button>
            <button class="nav-item" onclick="switchTab('boss-tab', this)"><span>‚öîÔ∏è</span><div>–ë–æ—Å—Å</div></button>
            <button class="nav-item" onclick="switchTab('factory', this)"><span>üè≠</span><div>–§–∞–±—Ä–∏–∫–∞</div></button>
        </nav>
    </div>

    <script src="script.js"></script>
</body>
</html>